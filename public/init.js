const base_url="http://localhost:3000",css_url=base_url+"/widget.css";window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("script[data-feedlr-project-id]");var t=e?.getAttribute("data-feedlr-project-id");const d=e?.getAttribute("data-position-right"),l=e?.getAttribute("data-position-bottom");var o=e?.getAttribute("data-mode");const r=e?.getAttribute("data-toggler-style"),p=e?.getAttribute("data-input-style"),m=e?.getAttribute("data-button-style"),f=["hate","disappointed","natural","good","excellent"];let g="";const h=document.createElement("div");h.classList.add("feedlr-container"),"dark"===o&&h.classList.add("dark"),document.body.appendChild(h);let n=base_url+"/api/projects/widget?url="+window.location.host;t&&(n=base_url+"/api/projects/widget?id="+t);(()=>{const e=document.createElement("link");e.rel="stylesheet",e.href=css_url,document.head.appendChild(e)})(),(async()=>{fetch(n).then(e=>e.json()).then(e=>{if(e.url===window.location.host||e.setting.localhostEnabled){(()=>{const e=document.createElement("button");e.classList.add("feedlr-widget-toggler"),e.innerText="Feedback",e.style=r,h.appendChild(e)})(),(l=>{const r=document.createElement("div");r.classList.add("feedlr-widget"),r.classList.add("widget-fixed");const n=document.createElement("p");n.innerText=l.setting?l.setting.question.replaceAll("%name%",l.name):"What do you think about "+l.name+"?",n.classList.add("feedlr-question");const e=document.createElement("p");e.innerHTML=`
     Widget by <a href="https://feedlr.vercel.app" target="_blank">Feedlr.</a>
    `,e.classList.add("feedlr-footer_text");const s=document.createElement("form");s.classList.add("feedlr-form");const a=document.createElement("div");a.classList.add("feedlr-emoji-container"),f.forEach(t=>{const o=document.createElement("button");o.type="button";o.classList.add("feedlr-emoji-button");o.setAttribute("data-emoji",t);o.addEventListener("click",()=>{g=t;const e=document.querySelectorAll(".feedlr-selected-emoji");e.forEach(e=>{e.classList.remove("feedlr-selected-emoji")});o.classList.add("feedlr-selected-emoji");s.classList.add("show")});const e=document.createElement("img");e.src=base_url+"/widget/emojis/"+t+".gif";e.width=40;e.height=40;o.append(e);a.appendChild(o)});const i=document.createElement("input");i.type="email",i.classList.add("feedlr-email_input"),i.placeholder="Enter your email (Optional)",i.style=p;const c=document.createElement("textarea");c.required=true,c.classList.add("feedlr-feedback_input"),c.placeholder="Your feedback",c.style=p;const t=document.createElement("button");t.innerText="Submit Feedback",t.classList.add("feedlr-feedback_submit"),t.style=m,s.appendChild(i),s.appendChild(c),s.appendChild(t),s.appendChild(e);const u=document.createElement("div");u.classList.add("feedlr-thankyou-window"),u.innerText=l.setting.thankYouMessage,r.appendChild(n),r.appendChild(a),r.appendChild(s),h.appendChild(r),s.addEventListener("submit",e=>{e.preventDefault();const t=i.value;const o=c.value;const d=window.location.href;fetch(base_url+`/api/responses/create?email=${t}&feedback=${o}&from=${d}&projectId=${l.id}&emoji=${g}`).then(e=>{e.json()}).then(e=>{if(l.setting.coolDownResponse>0){let e=new Date;e.setDate(e.getDate()+parseInt(l.setting.coolDownResponse));localStorage.setItem("feedlr-response",`{created_at: ${new Date}, remove_until: ${e}}`)}});r.removeChild(n);r.removeChild(a);r.removeChild(s);r.appendChild(u);setInterval(()=>{const e=document.querySelector(".feedlr-container");e.style.display="none"},4e3)})})(e),(e=>{const t=document.querySelector(":root"),o=document.querySelector(".dark");if(d)t.style.setProperty("--feedlr-position-right",d+"px");if(l)t.style.setProperty("--feedlr-position-bottom",l+"px");t.style.setProperty("--feedlr-primary-color","#"+(e?e.lightModeButtonColor:"9261DF")),o?.style.setProperty("--feedlr-primary-color","#"+(e?e.darkModeButtonColor:"9261DF")),t.style.setProperty("--feedlr-widget-bg","#"+(e?e.lightModeBackground:"ffffff")),o?.style.setProperty("--feedlr-widget-bg","#"+(e?e.darkModeBackground:"0F0F0F")),t.style.setProperty("--feedlr-button-color","#"+(e?e.lightModeButtonColor:"9261DF")),o?.style.setProperty("--feedlr-button-color","#"+(e?e.darkModeButtonColor:"9261DF")),t.style.setProperty("--feedlr-text-color","#"+(e?e.lightModeTextColor:"9261DF")),o?.style.setProperty("--feedlr-text-color","#"+(e?e.darkModeTextColor:"9261DF"))})(e.setting);const t=document.querySelector(".feedlr-widget-toggler");console.log(t),t?.addEventListener("click",()=>{const e=document.querySelector(".feedlr-widget");console.log(e),e?.classList.toggle("feedlr-widget-show")})}}).catch(e=>console.log(e))})()});