const base_url="https://feedlr.vercel.app",css_url=base_url+"/widget.css";window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("script[data-feedlr-project-id]");var t=e?.getAttribute("data-feedlr-project-id");const d=e?.getAttribute("data-position-right"),r=e?.getAttribute("data-position-bottom");var o=e?.getAttribute("data-mode");const u=["hate","disappointed","natural","good","excellent"];let m="";const f=document.createElement("div");f.classList.add("feedlr-container"),"dark"===o&&f.classList.add("dark"),document.body.appendChild(f);let l=base_url+"/api/projects/widget?url="+window.location.host;t&&(l=base_url+"/api/projects/widget?id="+t);(()=>{const e=document.createElement("link");e.rel="stylesheet",e.href=css_url,document.head.appendChild(e)})(),(async()=>{fetch(l).then(e=>e.json()).then(e=>{if(e.url===window.location.host||e.setting.localhostEnabled){(()=>{const e=document.createElement("button");e.classList.add("feedlr-widget-toggler"),e.innerText="Feedback",f.appendChild(e)})(),(r=>{const l=document.createElement("div");l.classList.add("feedlr-widget"),l.classList.add("widget-fixed");const n=document.createElement("p");n.innerText=r.setting?r.setting.question.replaceAll("%name%",r.name):"What do you think about "+r.name+"?",n.classList.add("feedlr-question");const e=document.createElement("p");e.innerHTML=`
     Widget by <a href="https://feedlr.vercel.app" target="_blank">Feedlr.</a>
    `,e.classList.add("feedlr-footer_text");const s=document.createElement("form");s.classList.add("feedlr-form");const a=document.createElement("div");a.classList.add("feedlr-emoji-container"),u.forEach(t=>{const o=document.createElement("button");o.type="button";o.classList.add("feedlr-emoji-button");o.setAttribute("data-emoji",t);o.addEventListener("click",()=>{m=t;const e=document.querySelectorAll(".feedlr-selected-emoji");e.forEach(e=>{e.classList.remove("feedlr-selected-emoji")});o.classList.add("feedlr-selected-emoji");s.classList.add("show")});const e=document.createElement("img");e.src=base_url+"/widget/emojis/"+t+".gif";e.width=40;e.height=40;o.append(e);a.appendChild(o)});const c=document.createElement("input");c.type="email",c.classList.add("feedlr-email_input"),c.placeholder="Enter your email (Optional)";const i=document.createElement("textarea");i.required=true,i.classList.add("feedlr-feedback_input"),i.placeholder="Your feedback";const t=document.createElement("button");t.innerText="Submit Feedback",t.classList.add("feedlr-feedback_submit"),s.appendChild(c),s.appendChild(i),s.appendChild(t),s.appendChild(e);const p=document.createElement("div");p.classList.add("feedlr-thankyou-window"),p.innerText=r.setting.thankYouMessage,l.appendChild(n),l.appendChild(a),l.appendChild(s),f.appendChild(l),s.addEventListener("submit",e=>{e.preventDefault();const t=c.value;const o=i.value;const d=window.location.href;fetch(base_url+`/api/responses/create?email=${t}&feedback=${o}&from=${d}&projectId=${r.id}&emoji=${m}`).then(e=>{e.json()}).then(e=>{if(r.setting.coolDownResponse>0){let e=new Date;e.setDate(e.getDate()+parseInt(r.setting.coolDownResponse));localStorage.setItem("feedlr-response",`{created_at: ${new Date}, remove_until: ${e}}`)}});l.removeChild(n);l.removeChild(a);l.removeChild(s);l.appendChild(p);setInterval(()=>{const e=document.querySelector(".feedlr-container");e.style.display="none"},4e3)})})(e),(e=>{const t=document.querySelector(":root"),o=document.querySelector(".dark");if(d)t.style.setProperty("--feedlr-position-right",d+"px");if(r)t.style.setProperty("--feedlr-position-bottom",r+"px");t.style.setProperty("--feedlr-primary-color","#"+(e?e.lightModeButtonColor:"9261DF")),o?.style.setProperty("--feedlr-primary-color","#"+(e?e.darkModeButtonColor:"9261DF")),t.style.setProperty("--feedlr-widget-bg","#"+(e?e.lightModeBackground:"ffffff")),o?.style.setProperty("--feedlr-widget-bg","#"+(e?e.darkModeBackground:"0F0F0F")),t.style.setProperty("--feedlr-button-color","#"+(e?e.lightModeButtonColor:"9261DF")),o?.style.setProperty("--feedlr-button-color","#"+(e?e.darkModeButtonColor:"9261DF")),t.style.setProperty("--feedlr-text-color","#"+(e?e.lightModeTextColor:"9261DF")),o?.style.setProperty("--feedlr-text-color","#"+(e?e.darkModeTextColor:"9261DF"))})(e.setting);const t=document.querySelector(".feedlr-widget-toggler");console.log(t),t?.addEventListener("click",()=>{const e=document.querySelector(".feedlr-widget");console.log(e),e?.classList.toggle("feedlr-widget-show")})}}).catch(e=>console.log(e))})()});