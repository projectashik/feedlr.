const base_url="http://localhost:3000",css_url=base_url+"/widget.css";window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("script[data-feedlr-project-id]");var t=e?.getAttribute("data-feedlr-project-id");const o=["hate","disappointed","natural","good","excellent"];let p="";const d=document.createElement("div");d.classList.add("feedlr-container"),document.body.appendChild(d);let l=base_url+"/api/projects/widget?url="+window.location.host;t&&(l=base_url+"/api/projects/widget?id="+t);(()=>{const e=document.createElement("link");e.rel="stylesheet",e.href=css_url,document.head.appendChild(e)})(),(async()=>{fetch(l).then(e=>e.json()).then(e=>{e.url!==window.location.host&&!e.setting.localhostEnabled||((()=>{const e=document.createElement("button");e.classList.add("feedlr-widget-toggler"),e.innerText="Feedback",d.appendChild(e)})(),(l=>{const n=document.createElement("div");n.classList.add("feedlr-widget"),n.classList.add("widget-fixed");const r=document.createElement("p");r.innerText=l.setting?l.setting.question.replaceAll("%name%",l.name):"What do you think about "+l.name+"?",r.classList.add("feedlr-question");const e=document.createElement("p");e.innerHTML=`
     Widget by <a href="https://feedlr.vercel.app" target="_blank">Feedlr.</a>
    `,e.classList.add("feedlr-footer_text");const s=document.createElement("form");s.classList.add("feedlr-form");const a=document.createElement("div");a.classList.add("feedlr-emoji-container"),o.forEach(t=>{const o=document.createElement("button");o.type="button";o.classList.add("feedlr-emoji-button");o.setAttribute("data-emoji",t);o.addEventListener("click",()=>{p=t;const e=document.querySelectorAll(".feedlr-selected-emoji");e.forEach(e=>{e.classList.remove("feedlr-selected-emoji")});o.classList.add("feedlr-selected-emoji");s.classList.add("show")});const e=document.createElement("img");e.src=base_url+"/widget/emojis/"+t+".gif";e.width=40;e.height=40;o.append(e);a.appendChild(o)});const c=document.createElement("input");c.type="email",c.required=true,c.classList.add("feedlr-email_input"),c.placeholder="Enter your email";const i=document.createElement("textarea");i.required=true,i.classList.add("feedlr-feedback_input"),i.placeholder="Your feedback";const t=document.createElement("button");t.innerText="Submit Feedback",t.classList.add("feedlr-feedback_submit"),s.appendChild(c),s.appendChild(i),s.appendChild(t),s.appendChild(e);const u=document.createElement("div");u.classList.add("feedlr-thankyou-window"),u.innerText=l.setting.thankYouMessage,n.appendChild(r),n.appendChild(a),n.appendChild(s),d.appendChild(n),s.addEventListener("submit",e=>{e.preventDefault();const t=c.value;const o=i.value;const d=window.location.href;fetch(base_url+`/api/responses/create?email=${t}&feedback=${o}&from=${d}&projectId=${l.id}&emoji=${p}`).then(e=>{e.json()}).then(e=>{if(l.setting.coolDownResponse>0){let e=new Date;e.setDate(e.getDate()+parseInt(l.setting.coolDownResponse));localStorage.setItem("feedlr-response",`{created_at: ${new Date}, remove_until: ${e}}`)}});n.removeChild(r);n.removeChild(a);n.removeChild(s);n.appendChild(u);setInterval(()=>{const e=document.querySelector(".feedlr-container");e.style.display="none"},4e3)})})(e),(e=>{const t=document.querySelector(":root"),o=document.querySelector(".dark");t.style.setProperty("--feedlr-primary-color","#"+(e?e.lightModeButtonColor:"9261DF")),o?.style.setProperty("--feedlr-primary-color","#"+(e?e.darkModeButtonColor:"9261DF")),t.style.setProperty("--feedlr-widget-bg","#"+(e?e.lightModeBackground:"ffffff")),o?.style.setProperty("--feedlr-widget-bg","#"+(e?e.darkModeBackground:"0F0F0F")),t.style.setProperty("--feedlr-button-color","#"+(e?e.lightModeButtonColor:"9261DF")),o?.style.setProperty("--feedlr-button-color","#"+(e?e.darkModeButtonColor:"9261DF")),t.style.setProperty("--feedlr-text-color","#"+(e?e.lightModeTextColor:"9261DF")),o?.style.setProperty("--feedlr-text-color","#"+(e?e.darkModeTextColor:"9261DF"))})(e.setting))}).catch(e=>console.log(e))})()});